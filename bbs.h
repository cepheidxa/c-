#ifndef BBS_H_H_H
#define BBS_H_H_H

#include <iostream>
#include <gmpxx.h>

//Blum-Blum-Shub generator
class BBS_BASE {
public:
	template<typename T1, typename T2, typename T3>
	BBS_BASE(T1 p, T2 q, T3 x);
	mpz_class operator()(int bits);
	void getRand(void *buf, int len);
	template<typename T>
	void seed(T s);
private:
	virtual void instantiation() = 0;
	mpz_class mP;
	mpz_class mQ;
	mpz_class mX;
	mpz_class mN;
};

template<typename T1, typename T2, typename T3>
BBS_BASE::BBS_BASE(T1 p, T2 q, T3 x)
{
	mP = p;
	mQ = q;
	mX = x;
	mN = mP * mQ;
}

template<typename T>
void BBS_BASE::seed(T s)
{
	mX = s % mX;
}


template<int N>
class BBS:public BBS_BASE {
public:
	BBS();
private:
	void instantiation() {};
};

template<int N>
BBS<N>::BBS() :
	BBS_BASE(\
	/*mP*/\
	N <= 32? "187898092340890129676627803":\
	N <= 64? "113571352256491112160630394014305623":\
	N <= 128? "5746107066227089173155597137376157066457615723452125143":\
	N <= 256? "4138238585923508484254347416003651734176058041641005640834137890475695308424450829883073863047":\
	N <= 512? "239646554576446682289198974097363840281745267107474202121896053657183714671233394804230759242697273023449268506903980942929863700391086568219475493525424192404170821336899":\
	N <= 1024? "1414733410491072183319393544166130408467407968467655216326340554015283664573735534730841476653244568500461484197440856762244962704354404605042419005210222483460688319756490436618815855021643871503044960100148313111692315747329275023800106537212667599460550502482980411719395562265725881435677525628593878479477636466575531939":\
	N <= 2048? "1855670852098936381676495313597766227055288005659679919957509437786562685610646343538582091113180016696675244677087902052684202523375804987409624983131014257604101439894653378932248501965871457734041977580468568416976982342728842572458776682719311827983508299392722124025222214137896231342094023929207328378486123407039118141835648721114472030270994632246974437068867566632550516644150924549703089999983816520125014778111031169765033479563732849196392036404775515584357202736466193172471191287381588798773256678838268792083434672741178683877311714765665176458916427085818347274631373061531960128639781860922873440846958623091452771731":\
	"32924422100420260138881002993580963071424505159511707843370253678548911076966034182036776263269466658003609381023838583735113234593009282706687146207429796964709771761995719898000762771822359526357409373036850547234113908329962258894030217957679498753915987521656202179670585281614634635552454495671965001647990597741480026391654427160136018741297594112506379372933488481266591791225962940051392949660218073075498349917178460300518524126239474447230449639712863510989207645867012852646100048373358404278834352267299136425905074512975544142268213743016650350263309965387771231345814233711054444415794762492255624826482522169019128735949836325238964355133791616221674968145144681899351117583369427484815104468059670883297665732001305724225671665783476571322886732492196464035782357369702239068203429238902607283958513689022326688501191495199424278646476124428262698520552902019740606207241027709647928242808387617425804334717564167718585761647497401217537489821321096515636995204910010503391348377282720633448718857531890888103025187307021443702085570391857025690421855893659417178942967510183850390468402136873447331733951571465849890236978474060339641878899742094176701318502788214020962040289078190021257047452423007005998140914674209807566349749903",\
	/*mQ*/\
	N <= 64? "168413715541561259994323091212201819":\
	N <= 128? "12307476283655101189834659807429247113635907413621595907":\
	N <= 256? "7854293508578963601748239079202886020703991610726162399061533660455969828709230154926058335831":\
	N <= 512? "904741152165958334842336903628283165578668876925392984524453723797711905175736638741158505965659300717034520673771606313292649785559017907983182157003518959862274722873261":\
	N <= 1024? "3178211993781645733127831831137426988071160362134923364794172746707559381610914670839967578491880867794120045402084336086941075533995271922931037932794062385171692471199375772440992307563677586663215507101524001596601839850584457100179568154517999055402887566544006638814643942478484736961167122073314453821659009435739866431":\
	N <= 2048? "2299970521039949235000760540328301803373366933903040723585456675130445433448262628084546605350504734763763758772776521483422929697994201751084586672488606174390895447962866186730092932496903690426582966284506332145426317025170869077461811236267144526405568946449928768978962549125786766454367492915012759226012665090990398398149606015201770975937938184319634369451166823616900431479854311434766175924784014026287298390066883427916341012941867118888140985796540129104088932793332777717449704558184199900984876563817739210629368726205424032755997144952975345886026709900230561862065446071564298378716155914073860326132509032749352353543":\
	"2057637327177477017799367140628517277658464700585223366210006040968279923520655041219871318805122178115067710808795150866976922594877108692412357968501919865282534867071547967967827094743645923368790893900815371365601367415329595876427957791586081308056525969453321539973806535400930748268955070661239863616446946222222033800404271572139978887354114682069617444326055764629554020856018448903023092373145639628116946304581383371155975427811461968001148557909775926593311151849419289130047496144925200501593548609750467493727967454920819076940791879262502798435863434884544672734311342727113912819642009509813053984581340938096458795829469794306772952702086158937509102299041684500044208959350371010778286211998035443952743484763432272481911231425320555055843493235534683319086994621113755126759169375514616410006874561642727986851138135815946316075377823054723481029675983127100393314992854324028013583621425833871852629443546734054010666014665512395552352581948915966731347335358516031939375563560771756025837985799893776094281566380132113832880944984847162800674794630034251366220149530150805078569051027154244956851283874970152806237633353636474209645811660898593100911220034173430064548819579151311472776267054782634819592981749553714245080644851",\
	/*mX*/\
	N <= 64? "462094137999996007268790221754317633":\
	N <= 128? "18852760213883546429120271119806802556063293294570863387":\
	N <= 256? "4000229398041179814379216798219526459112568205314892120764937843901642670043328384476129468203":\
	N <= 512? "79237547502985286804546253029885287194815504891258169042950528714556502036514260041639358456678094811962582711003579076545990564510656384789761386402668093556542284986681":\
	N <= 1024? "6716577662539412262479175536113078165823727362985898973269392678671175311567728287912902396045981896035036128198418650387124707743484113343661490301789105922938294568545737597056910833573429407568488229667965138868451246669851917832790472121755236623770842906746158589167809299411330323198686059215733786261340582639747202829":\
	N <= 2048? "1571976477486620664942211250993957593485529816404626666259289431942272807450794084554732370068797327124210184091691937259754238771571139821406826508631561317762096021417020793157399595675363022648286302175298841355648006543698558584969301226173004770139217208765169187777859813961901785853781549826853122067870739111033979635645305226265432994612828183425315927179679239624938429474551879124491560452916624962000517043316204925061057227964050103682669145820485099227155040406527022197574293244979301387862400413964531466375591627465527491072169078614171748145198812958780885357146097819077295402569176014213730823242333756219570744233":\
	 "34761873989493988069650092743309081828870756317630403184858496056737270967497575400147920117375425636526594161744426296405056940275916030984268877431115837916420008865592507144298637922382233615148808307434001786247452696911547510578441424728688999812463289127510768264769036206631104697295514305964782523609459158825460884192764238121020628513346557278754178794231584896873453999644525789365321365759862455956325853688724142357868559225231753723783371376576238948988383165113279501543286722376848960762054024022070933273150478793949168658139292430171833604249463768795999794039466735595438245297688880372823178516739967605595141581424533115986112953303872234852032637918317613419888388733876876644420149919406842750731654924642503959630227672932663593663477835965733129591535898334689832493412734731357406149838618009145032836758115345431432464383324984600242404238613151366678750929213037219997137376817575997883281890371462001571011708650702149558370662039724144510171415125742225455162503752088759319875661924229957084561733032807527490593292367661710299398590933741355930528072138944678039166713848975075098583877975666733161238749707542024944038298633612033590223861818058773109040769446108476267883993075690442989080222489178948739068573118297"\
 )
{
}

typedef BBS<64> BBS64;
typedef BBS<128> BBS128;
typedef BBS<256> BBS256;
typedef BBS<512> BBS512;
typedef BBS<1024> BBS1024;
typedef BBS<2048> BBS2048;
typedef BBS<4096> BBS4096;

#endif
